<!doctype html><html class="not-ready lg:text-base" style=--bg:#faf8f1 lang=en-us dir=ltr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Unpacked: Double Machine Learning- Learning Out Loud - (LOL)</title>
<meta name=theme-color><meta name=description content="
You&rsquo;ve all heard about Machine Learning. Some say it&rsquo;s amazing; I say it&rsquo;s meh. I&rsquo;d rather double it and give it to the next person (See what I did there?). This next person happens to be you. You guessed it today we will talk about Double Machine Learning (Double ML)
For now, we’ll focus on how Double ML is used to compute the Average Treatment Effect (ATE). Conditional ATE (CATE) might come later."><meta name=author content="Gaspard Thoral"><link rel="preload stylesheet" as=style href=../../main.min.css><link rel=preload as=image href=../../theme.svg><link rel=preload as=image href=../../github.svg><link rel=preload as=image href=../../linkedin.svg><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css integrity=sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js integrity=sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",()=>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1}))</script><link rel=icon href=../../favicon.ico><link rel=apple-touch-icon href=../../apple-touch-icon.png><meta name=generator content="Hugo 0.145.0"><meta itemprop=name content="Unpacked: Double Machine Learning"><meta itemprop=description content="You’ve all heard about Machine Learning. Some say it’s amazing; I say it’s meh. I’d rather double it and give it to the next person (See what I did there?). This next person happens to be you. You guessed it today we will talk about Double Machine Learning (Double ML)
For now, we’ll focus on how Double ML is used to compute the Average Treatment Effect (ATE). Conditional ATE (CATE) might come later."><meta itemprop=datePublished content="2025-03-14T00:00:00+00:00"><meta itemprop=dateModified content="2025-03-14T00:00:00+00:00"><meta itemprop=wordCount content="996"><meta property="og:url" content="/post/double_ml/"><meta property="og:site_name" content=" Learning Out Loud - (LOL)"><meta property="og:title" content="Unpacked: Double Machine Learning"><meta property="og:description" content="You’ve all heard about Machine Learning. Some say it’s amazing; I say it’s meh. I’d rather double it and give it to the next person (See what I did there?). This next person happens to be you. You guessed it today we will talk about Double Machine Learning (Double ML)
For now, we’ll focus on how Double ML is used to compute the Average Treatment Effect (ATE). Conditional ATE (CATE) might come later."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-03-14T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-14T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Unpacked: Double Machine Learning"><meta name=twitter:description content="You’ve all heard about Machine Learning. Some say it’s amazing; I say it’s meh. I’d rather double it and give it to the next person (See what I did there?). This next person happens to be you. You guessed it today we will talk about Double Machine Learning (Double ML)
For now, we’ll focus on how Double ML is used to compute the Average Treatment Effect (ATE). Conditional ATE (CATE) might come later."><link rel=canonical href=../../post/double_ml/></head><body class="text-black duration-200 ease-out dark:text-white"><header class="mx-auto flex h-[4.5rem] max-w-(--w) px-8 whitespace-nowrap lg:justify-center"><div class="relative z-50 flex items-center ltr:mr-auto rtl:ml-auto"><a class="-translate-y-[1px] text-2xl font-medium" href=../../>Learning Out Loud - (LOL)</a><div class="btn-dark text-[0px] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.svg)_left_center/cover_no-repeat] dark:invert dark:[background-position:right]" role=button aria-label=Dark></div></div><div class="btn-menu relative z-50 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden ltr:-mr-8 rtl:-ml-8" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.toggle("open")});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg="#faf8f1".replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"#000":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark"))setDark(!0);else{const e=localStorage.getItem("dark");setDark(e?e==="true":darkScheme.matches)}darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full flex-col justify-center pb-16 duration-200 select-none lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none dark:bg-black"><nav class="mt-12 flex justify-center space-x-10 lg:mt-0 lg:items-center ltr:lg:ml-14 rtl:space-x-reverse rtl:lg:mr-14 dark:invert"><a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./github.svg) href=https://github.com/gaspardthrl target=_blank rel=me>github</a>
<a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./linkedin.svg) href=https://linkedin.com/in/gaspard-thoral-49538a230/ target=_blank rel=me>linkedin</a></nav></div></header><main class="prose prose-neutral dark:prose-invert relative mx-auto min-h-[calc(100vh-9rem)] max-w-(--w) px-8 pt-14 pb-16"><article><header class=mb-14><h1 class="!my-0 pb-2.5">Unpacked: Double Machine Learning</h1><div class="text-xs antialiased opacity-60"></div></header><section><p>You&rsquo;ve all heard about Machine Learning. Some say it&rsquo;s amazing; I say it&rsquo;s meh. I&rsquo;d rather <em>double it</em> and give it to the next person (See what I did there?). This next person happens to be you. You guessed it today we will talk about <strong>Double Machine Learning (Double ML)</strong></p><p>For now, we’ll focus on how Double ML is used to compute the <strong>Average Treatment Effect (ATE)</strong>. Conditional ATE (CATE) might come later.</p><h1 id=introduction-causation-vs-correlation>Introduction: Causation vs. Correlation</h1><p>Before diving into Double ML, let’s talk about <strong>causation</strong> and <strong>correlation</strong>.</p><p>Imagine we have a population, and for each individual $i$ we observe an outcome $Y_i$ . Now, suppose we’re interested in understanding the effect of some treatment $T$ on an this outcome.</p><p>Each $Y_i$ has <strong>two potential outcomes</strong>:</p><ul><li>$Y_i(0)$ → The outcome if the individual <strong>did not</strong> receive the treatment.</li><li>$Y_i(1)$ → The outcome if the individual <strong>did</strong> receive the treatment.</li></ul><p>However, here’s the catch: <strong>We can only observe one of these outcomes per individual</strong>. If someone receives the treatment, we’ll see $Y_i(1)$, but we’ll never know what $Y_i(0)$ would have been (and vice versa).</p><p>The goal of <strong>causal inference</strong> is to estimate the effect of the treatment:</p>$$
Y_i(1) - Y_i(0)
$$<p>Since we can’t measure this for each individual, we instead try to estimate the <strong>population-level effect</strong>:</p>$$
E[Y(1) - Y(0)]
$$<p>where the expectation is taken over the entire population.</p><h3 id=why-you-cant-just-compare-treated-vs-untreated-groups>Why You Can’t Just Compare Treated vs. Untreated Groups</h3><p>A common mistake is to estimate the treatment effect using:</p>$$
\begin{equation}
E[Y | T = 1] - E[Y | T = 0]
\end{equation}
$$<p>which seems reasonable at first: it compares the average outcome of treated vs. untreated individuals. But <strong>this is wrong</strong> because it captures <strong>association, not causation</strong>.</p><p>Let’s expand the terms:</p>$$
E[Y | T = 1] - E[Y | T = 0] = E[Y(1) | T = 1] - E[Y(0) | T = 0]
$$<p>By adding and subtracting $E[Y(0) | T = 1]$, we get:</p>$$
\underbrace{E[Y(1) | T = 1] - E[Y(0) | T = 1]}_{\text{ATT (Average Treatment Effect on the Treated)}} + \underbrace{E[Y(0) | T = 1] - E[Y(0) | T = 0]}_{\text{Bias}}
$$<p>The second term (Bias) represents the difference between treated and untreated individuals <strong>before</strong> treatment. It captures pre-existing differences (<em>confounders</em>) rather than the causal effect.</p><h3 id=what-does-it-look-like-with-a-basic-example->What does it look like with a basic example ?</h3><p>Let&rsquo;s say we want to understand the impact of a taking a specific <em>food supplement</em> on someone&rsquo;s height but we don&rsquo;t want to perform any <strong>randomized controlled trials</strong> or any experiment that would grant us new data. We only want to work with <strong>already available data</strong>.</p><p>What we have is a population $Y$ inside which some people took this food supplement and others didn&rsquo;t.</p><p><strong>NB:</strong> In our experiment, $Y_i$ represents the <strong>height</strong> of the $i^{\text{th}}$ individual.</p><p>Here is our data:</p><table><thead><tr><th style=text-align:left>$\text{Individual}$</th><th style=text-align:center>$Y(0)$</th><th style=text-align:center>$Y(1)$</th><th style=text-align:center>$T$</th></tr></thead><tbody><tr><td style=text-align:left>$1$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$186$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:left>$2$</td><td style=text-align:center>$171$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$0$</td></tr><tr><td style=text-align:left>$3$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$190$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:left>$4$</td><td style=text-align:center>$174$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$0$</td></tr><tr><td style=text-align:left>$5$</td><td style=text-align:center>$169$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$0$</td></tr><tr><td style=text-align:left>$6$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$185$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:left>$7$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$195$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:left>$8$</td><td style=text-align:center>$170$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$0$</td></tr></tbody></table><p>Let&rsquo;s try with $(1)$ :</p><ul><li><p>We first compute the average height of <strong>people who did not took the food supplement</strong></p><p>$\Rightarrow E[Y | T = 0] = \frac{171 + 174 + 169 + 170}{4} = 171$</p></li><li><p>We then compute the average height of <strong>people who took the food supplement</strong></p><p>$\Rightarrow E[Y | T = 1] = \frac{186 + 190 + 185 + 195}{4} = 189$</p></li></ul><p>Applying the above formula we find that taking the food supplement results in a height increase of $189 - 171 = 18\text{cm}$.</p><p>Well that&rsquo;s awesome ! Where can I find this amazing supplement ?</p><p>For the sake of this experiment we were granted a time machine. Let&rsquo;s go back in time just to make sure our results are correct.</p><p>After our little trip we are back with this updated table</p><table><thead><tr><th style=text-align:left>$\text{Individual}$</th><th style=text-align:center>$Y(0)$</th><th style=text-align:center>$Y(1)$</th><th style=text-align:center>$T$</th></tr></thead><tbody><tr><td style=text-align:left>$1$</td><td style=text-align:center>$186$</td><td style=text-align:center>$186$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:left>$2$</td><td style=text-align:center>$171$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$0$</td></tr><tr><td style=text-align:left>$3$</td><td style=text-align:center>$190$</td><td style=text-align:center>$190$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:left>$4$</td><td style=text-align:center>$174$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$0$</td></tr><tr><td style=text-align:left>$5$</td><td style=text-align:center>$169$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$0$</td></tr><tr><td style=text-align:left>$6$</td><td style=text-align:center>$185$</td><td style=text-align:center>$185$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:left>$7$</td><td style=text-align:center>$195$</td><td style=text-align:center>$195$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:left>$8$</td><td style=text-align:center>$170$</td><td style=text-align:center>$\color{red}\textbf{?}$</td><td style=text-align:center>$0$</td></tr></tbody></table><p>Remember how $(1)$ included a $\text{Bias}$ term when we expanded it ? Let&rsquo;s see what it looks like with our new data.</p><ul><li><p>We compute once again the average height of <strong>people who took the food supplement</strong> before they actually took it</p><p>$\Rightarrow E[Y(0) | T = 0] = \frac{171 + 174 + 169 + 170}{4} = 171$</p></li><li><p>Now, let&rsquo;s compute the average height of these same individuals <strong>before</strong> they took the supplement</p><p>$\Rightarrow E[Y(0) | T = 1] = \frac{186 + 190 + 185 + 195}{4} = 189$</p></li></ul><p>We find that the <em>bias</em>, that is the initial difference between the two sub-populations, is of $18 \text{cm}$.</p><p><em>Wait&mldr; What ???</em></p><p>This means that the $\text{ATT}$, the average treatment effect on the treated, is actually $\text{0}$. In other words, the supplement had no effect at all: the difference we observed was purely due to <strong>pre-existing height differences between the two groups</strong>.</p><p>We were lucky to have our time machine to reveal the truth but as you may have noticed, we don&rsquo;t have that luxury in real life. Since we can never observe both outcomes $Y(0)$ and $Y(1)$ for the same individual, we must be extra cautious. Without a properly designed experiment, we risk mistaking correlation for causation, leading to completely false conclusions.</p><p>This is why randomized controlled trials are so valuable: they <strong>help us separate real effects from misleading associations</strong>.</p><p>But what if we cannot perform RCTs ?</p><h1 id=computing-the-ate>Computing the ATE</h1><p>Let&rsquo;s recap a bit. We have our outcome $Y_i$ for each individual. It can be expressed as</p>$$
Y_i(T) = T\tau_i + f(\bold{X}_i)\boldsymbol{\beta}_i + \epsilon_i
$$<p>where $T$ represents whether we applied the treatment or not, $\tau_i$ the impact of the treatment on our outcome $i$, $f(\bold{X}_i)$ all elements that have an impact on our outcome, $\boldsymbol{\beta}_i$ their impacts, and $\epsilon_i$ the error term.</p><p>As you can see, subtracting $Y_i(1) - Y_i(0)$ does give us $\tau_i$, the impact of the treatment.</p></section><div class=mt-24 id=graphcomment></div><script type=text/javascript>var __semio__params={graphcommentId:"YOUR_GRAPH_COMMENT_ID",behaviour:{}};function __semio__onload(){__semio__gc_graphlogin(__semio__params)}(function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.onload=__semio__onload,e.defer=!0,e.src="https://integration.graphcomment.com/gc_graphlogin.js?"+Date.now(),(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script></article></main><footer class="mx-auto flex h-[4.5rem] max-w-(--w) items-center px-8 text-xs tracking-wider uppercase opacity-60"><div class=mr-auto>&copy;2025<a class=link href=../../> Learning Out Loud - (LOL)</a></div></footer></body></html>